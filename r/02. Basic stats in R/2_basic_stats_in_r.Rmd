---
title: "Applied Econometrics 2, Basic stats in R"
author: "Евгений Орлов"
date: "20.11.2014"
output:
  word_document: default
  html_document: default
---

### Данные

В качестве входных данных взяты цены закрытия по обыкновенным акциям Сбербанка 
в период с 01.01.2010 по 07.11.2014 включительно.

Источником данных выступила ИТС QUIK.

```{r}
sber.df <- read.csv("Сбербанк [Price].txt", header=TRUE)
tail(sber.df)
# Цены закрытия начиная с 01.01.2010 по 07.11.2014 включительно
sber.close <- sber.df[sber.df$X.DATE. >= 20100101, "X.CLOSE."]
# Длина выборки 
scl <- length(sber.close)
print(paste0("Размер выборки: ", scl))
# Вектор доходностей
sber.ret <- sber.close[2:scl] / sber.close[1:(scl-1)] - 1
```

Графики цен закрытия и доходностей:

```{r echo=FALSE}
sber.dates <- sber.df[sber.df$X.DATE. >= 20100101, "X.DATE."]
sber.dates <- as.Date(as.character(sber.dates), format="%Y%m%d")
```

```{r}
# График цен закрытия
plot(sber.dates, sber.close, 
     type='l', xlab='index', ylab='close', main='Sberbank:Close')
# График доходностей
plot(sber.dates[-1], sber.ret, 
     type='l', xlab='index', ylab='return', main='Sberbank:Return')
```

### Тесты на нормальность

Тестируем распределение доходностей на нормальность с помощью 
тестов Шапиро-Уилка и Колмогорова-Смирнова:

```{r}
# Тесты на нормальность
shapiro.test(sber.ret)
ks.test(sber.ret, 'pnorm', mean=mean(sber.ret), sd=sd(sber.ret))
```

Оба теста показывают, что вероятность получить на практике фактическую выборку доходностей в предположении нормальности распределения крайне мала 
(p-value << 0.01).

Можно сделать вывод, что для достаточно низкого уровня значимости 
распределение доходностей обыкновенных акций не является нормальным.

При этом, фактические данные не противоречат гипотезе о симметричности 
распределения (тест Миао, Гэла, Гэствирта(2006)):

```{r}
# Тест на симметричность распределения
library(lawstat, quietly=TRUE)
symmetry.test(sber.ret)
```

Подтвердим результаты, полученные в тестах, визуально.

### Визуальный анализ данных

Построим график "нормальный квантиль-квантиль".

```{r}
qqnorm(sber.ret)
qqline(sber.ret)
```

На графике хорошо заметно, что распределение выборки имеет более толстые хвосты, 
чем нормальное распреление.

Сопоставим гистограмму выборки с нормальным распределением.

```{r}
library(fBasics, quietly=TRUE)
histPlot(timeSeries(sber.ret))
```

График подчеркивает островершинность распределения (excess kurtosis > 0).

### Вывод

Исходя из полученных результатов, можно сделать вывод, что рассмотренной 
выборке дневной доходности обыкновенных акций Сбербанка соответстует 
симметричное островершинное распределение с толстыми (по сравнению с 
нормальным распределением) хвостами.
